#include "Symmetry/CharacterTable.hpp"

#include <cmath>
#include <iomanip>
#include <sstream>

namespace
{

// returns the real part of e^(2 * pi * i / k)
double thetaRe(float k)
{
    return cos(2 * M_PI / k);
}
// returns the imaginary part of e^(2 * pi * i / k)
double thetaIm(float k)
{
    return sin(2 * M_PI / k);
}

// map to hold character tables
std::unordered_map<std::string, Symmetry::CharacterTable> tables = {
    {"C1", {{"A"}, {"E"}, {{1}}}},
    {"Ci", {{"Ag", "Au"}, {"E", "i"}, {{1, 1}, {1, -1}}}},
    {"Cs", {{"A'", "A''"}, {"E", "sigmah"}, {{1, 1}, {1, -1}}}},
    {"C2", {{"A", "B"}, {"E", "C2"}, {{1, 1}, {1, -1}}}},
    {"C2h",
     {{"Ag", "Bg", "Au", "Bu"}, {"E", "C2", "i", "sigmah"}, {{1, 1, 1, 1}, {1, -1, 1, -1}, {1, 1, -1, -1}, {1, -1, -1, 1}}}},
    {"C2v",
     {{"A1", "A2", "B1", "B2"},
      {"E", "C2", "sigmaxz", "sigmayz"},
      {{1, 1, 1, 1}, {1, 1, -1, -1}, {1, -1, 1, -1}, {1, -1, -1, 1}}}},
    {"C3", {{"A", "E+", "E-"}, {"E", "C3", "C3^2"}, {{1, 1, 1}, {1, -0.5, -0.5}, {0, thetaIm(3), -thetaIm(3)}}}},
    {
        "C3h",
        {{"A'", "E'+", "E'-", "A''", "E''+", "E''-"},
         {"E", "C3", "C3^2", "sigmah", "S3", "S3^5"},
         {{1, 1, 1, 1, 1, 1},
          {1, -0.5, -0.5, 1, -0.5, -0.5},
          {0, thetaIm(3), -thetaIm(3), 0, thetaIm(3), -thetaIm(3)},
          {1, 1, 1, -1, -1, -1},
          {1, -0.5, -0.5, -1, 0.5, 0.5},
          {0, thetaIm(3), -thetaIm(3), 0, -thetaIm(3), thetaIm(3)}}},
    },
    {"C3v", {{"A1", "A2", "E"}, {"E", "2C3", "3sigmav"}, {{1, 1, 1}, {1, 1, -1}, {2, -1, 0}}}},
    {"C4",
     {{"A", "B", "E+", "E-"}, {"E", "C4", "C2", "C4^3"}, {{1, 1, 1, 1}, {1, -1, 1, -1}, {1, 0, -1, 0}, {0, 1, 0, -1}}}},
    {"C4h",
     {{"Ag", "Bg", "Eg+", "Eg-", "Au", "Bu", "Eu+", "Eu-"},
      {"E", "C4", "C2", "C4^3", "i", "S4^3", "sigmah", "S4"},
      {
          {1, 1, 1, 1, 1, 1, 1, 1},
          {1, -1, 1, -1, 1, -1, 1, -1},
          {1, 0, -1, 0, 1, 0, -1, 0},
          {0, 1, 0, 1, 0, 1, 0, -1},
          {1, 1, 1, 1, -1, -1, -1, -1},
          {1, -1, 1, -1, -1, 1, -1, 1},
          {1, 0, -1, 0, -1, 0, 1, 0},
          {0, 1, 0, -1, 0, -1, 0, 1},
      }}},
    {"C4v",
     {{"A1", "A2", "B1", "B2", "E"},
      {"E", "C2", "2C4", "2sigmav", "2sigmad"},
      {{1, 1, 1, 1, 1}, {1, 1, 1, -1, -1}, {1, 1, -1, 1, -1}, {1, 1, -1, -1, 1}, {2, -2, 0, 0, 0}}}},
    {"C5",
     {{"A", "E1+", "E1-", "E2+", "E2-"},
      {"E", "C5", "C5^2", "C5^3", "C5^4"},
      {{1, 1, 1, 1, 1},
       {1, thetaRe(5), thetaRe(2.5), thetaRe(2.5), thetaRe(5)},
       {0, thetaIm(5), thetaIm(2.5), -thetaIm(2.5), -thetaIm(5)},
       {1, thetaRe(2.5), thetaRe(5), thetaRe(5), thetaRe(2.5)},
       {0, thetaIm(2.5), -thetaIm(5), thetaIm(5), -thetaIm(2.5)}}}},
    {"C5h",
     {{"A'", "E1'+", "E1'-", "E2'+", "E2'-", "A''", "E1''+", "E1''-", "E2''+", "E2''-"},
      {"E", "C5", "C5^2", "C5^3", "C5^4", "sigmah", "S5", "S5^7", "S5^3", "S5^9"},
      {{1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
       {1, thetaRe(5), thetaRe(2.5), thetaRe(2.5), thetaRe(5), 1, thetaRe(5), thetaRe(2.5), thetaRe(2.5), thetaRe(5)},
       {0, thetaIm(5), thetaIm(2.5), -thetaIm(2.5), -thetaIm(5), 0, thetaIm(5), thetaIm(2.5), -thetaIm(2.5), -thetaIm(5)},
       {1, thetaRe(2.5), thetaRe(5), thetaRe(5), thetaRe(2.5), 1, thetaRe(2.5), thetaRe(5), thetaRe(5), thetaRe(2.5)},
       {0, thetaIm(2.5), -thetaIm(5), thetaIm(5), -thetaIm(2.5), 0, thetaIm(2.5), -thetaIm(5), thetaIm(5), -thetaIm(2.5)},
       {1, 1, 1, 1, 1, -1, -1, -1, -1, -1},
       {1, thetaRe(5), thetaRe(2.5), thetaRe(2.5), thetaRe(5), -1, -thetaRe(5), -thetaRe(.5), -thetaRe(2.5), -thetaRe(5)},
       {0, thetaIm(5), thetaIm(2.5), -thetaIm(2.5), -thetaIm(5), 0, -thetaIm(5), -thetaIm(2.5), thetaIm(2.5), thetaIm(5)},
       {1, thetaRe(2.5), thetaRe(5), thetaRe(5), thetaRe(2.5), -1, -thetaRe(2.5), -thetaRe(5), -thetaRe(5), -thetaRe(2.5)},
       {0, thetaIm(2.5), -thetaIm(5), thetaIm(5), -thetaIm(2.5), 0, -thetaIm(2.5), thetaIm(5), -thetaIm(5), thetaIm(2.5)}}}},
    {"C5v",
     {{"A1", "A2", "E1", "E2"},
      {"E", "2C5", "2C5^2", "5sigmav"},
      {{1, 1, 1, 1}, {1, 1, 1, -1}, {2, 2 * thetaRe(5), 2 * thetaRe(2.5), 0}, {2, 2 * thetaRe(2.5), 2 * thetaRe(5), 0}}}},
    {"C6",
     {{"A", "B", "E1+", "E1-", "E2+", "E2-"},
      {"E", "C6", "C3", "C2", "C3^2", "C6^5"},
      {{1, 1, 1, 1, 1, 1},
       {1, -1, 1, -1, 1, -1},
       {1, 0.5, -0.5, -1, -0.5, 0.5},
       {0, thetaIm(6), thetaIm(6), 0, -thetaIm(6), -thetaIm(6)},
       {1, -0.5, -0.5, 1, -0.5, -0.5},
       {0, thetaIm(6), -thetaIm(6), 0, thetaIm(6), -thetaIm(6)}}}},
    {"C6h",
     {{"Ag", "Bg", "E1g+", "E1g-", "E2g+", "E2g-", "Au", "Bu", "E1u+", "E1u-", "E2u+", "E2u-"},
      {"E", "C6", "C3", "C2", "C3^2", "C6^5", "i", "S3^5", "S6^5", "sigmah", "S6", "S3"},
      {{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
       {1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1},
       {1, 0.5, -0.5, -1, -0.5, 0.5, 1, 0.5, -0.5, -1, -0.5, 0.5},
       {0, thetaIm(6), thetaIm(6), 0, -thetaIm(6), -thetaIm(6), 0, thetaIm(6), thetaIm(6), 0, -thetaIm(6), -thetaIm(6)},
       {1, -0.5, -0.5, 1, -0.5, -0.5, 1, -0.5, -0.5, 1, -0.5, -0.5},
       {0, thetaIm(6), -thetaIm(6), 0, thetaIm(6), -thetaIm(6), 0, thetaIm(6), -thetaIm(6), 0, thetaIm(6), -thetaIm(6)},
       {1, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -1},
       {1, -1, 1, -1, 1, -1, -1, 1, -1, 1, -1, 1},
       {1, 0.5, -0.5, -1, -0.5, 0.5, -1, -0.5, 0.5, 1, 0.5, -0.5},
       {0, thetaIm(6), thetaIm(6), 0, -thetaIm(6), -thetaIm(6), 0, -thetaIm(6), -thetaIm(6), 0, thetaIm(6), thetaIm(6)},
       {1, -0.5, -0.5, 1, -0.5, -0.5, -1, 0.5, 0.5, -1, 0.5, 0.5},
       {0, thetaIm(6), -thetaIm(6), 0, thetaIm(6), -thetaIm(6), 0, -thetaIm(6), thetaIm(6), 0, -thetaIm(6), thetaIm(6)}}}},
    {"C6v",
     {{"A1", "A2", "B1", "B2", "E1", "E2"},
      {"E", "C2", "C3", "C6", "sigmav", "sigmad"},
      {{1, 1, 1, 1, 1, 1},
       {1, 1, 1, 1, -1, -1},
       {1, -1, 1, -1, 1, -1},
       {1, -1, 1, -1, -1, 1},
       {2, -2, -1, 1, 0, 0},
       {2, 2, -1, -1, 0, 0}}}},
    {"C7",
     {{"A", "E1+", "E1-", "E2+", "E2-", "E3+", "E3-"},
      {"E", "C7", "C7^2", "C7^3", "C7^4", "C7^5", "C7^6"},
      {{1, 1, 1, 1, 1, 1, 1},
       {1, thetaRe(7), thetaRe(3.5), thetaRe(7 / 3), thetaRe(7 / 3), thetaRe(3.5), thetaRe(7)},
       {0, thetaIm(7), thetaIm(3.5), -thetaIm(7 / 3), thetaIm(7 / 3), -thetaIm(3.5), -thetaIm(7)},
       {1, thetaRe(3.5), thetaRe(7 / 3), thetaRe(7), thetaRe(7), thetaRe(7 / 3), thetaRe(3.5)},
       {0, thetaIm(3.5), thetaIm(7 / 3), -thetaIm(7), thetaIm(7), -thetaIm(7 / 3), -thetaIm(3.5)},
       {1, thetaRe(7 / 3), thetaRe(7), thetaRe(3.5), thetaRe(2.5), thetaRe(7), thetaRe(7 / 3)},
       {0, -thetaIm(7 / 3), -thetaIm(7), thetaIm(3.5), -thetaIm(3.5), thetaIm(7), thetaIm(7 / 3)}}}},
    {"C7v",
     {{"A1", "A2", "E1", "E2", "E3"},
      {"E", "2C7", "2C7^2", "2C7^3", "7sigmav"},
      {{1, 1, 1, 1, 1},
       {1, 1, 1, 1, -1},
       {2, 2 * thetaRe(7), 2 * thetaRe(3.5), 2 * thetaRe(7 / 3), 0},
       {2, 2 * thetaRe(3.5), 2 * thetaRe(7 / 3), 2 * thetaRe(7), 0},
       {2, 2 * thetaRe(7 / 3), 2 * thetaRe(7), 2 * thetaRe(3.5), 0}}}},
    {"C8",
     {{"A", "B", "E1+", "E1-", "E2+", "E2-", "E3+", "E3-"},
      {"E", "C8", "C4", "C2", "C4^3", "C8^3", "C8^5", "C8^7"},
      {{1, 1, 1, 1, 1, 1, 1, 1},
       {1, -1, 1, 1, 1, -1, -1, -1},
       {1, thetaRe(8), 0, -1, 0, -thetaRe(8), -thetaRe(8), thetaRe(8)},
       {0, 0, 1, 0, -1, 0, 0, 0},
       {1, 0, -1, 1, -1, 0, 0, 0},
       {0, 1, 0, 0, 0, -1, 1, -1},
       {1, -thetaRe(8), 0, -1, 0, thetaRe(8), thetaRe(8), -thetaRe(8)},
       {0, 0, 1, 0, -1, 0, 0, 0}}}},
    {"D2",
     {{"A1", "B1", "B2", "B3"}, {"E", "C2z", "C2y", "C2x"}, {{1, 1, 1, 1}, {1, 1, -1, -1}, {1, -1, 1, -1}, {1, -1, -1, 1}}}},
    {"D2d",
     {{"A1", "A2", "B1", "B2", "E"},
      {"E", "C2", "2S4", "2C2'", "2sigmad"},
      {{1, 1, 1, 1, 1}, {1, 1, 1, -1, -1}, {1, 1, -1, 1, -1}, {1, 1, -1, -1, 1}, {2, -2, 0, 0, 0}}}},
    {"D2h",
     {{"Ag", "B1g", "B2g", "B3g", "Au", "B1u", "B2u", "B3u"},
      {"E", "C2z", "C2y", "C2x", "i", "sigmaxy", "sigmaxz", "sigmayz"},
      {{1, 1, 1, 1, 1, 1, 1, 1},
       {1, 1, -1, -1, 1, 1, -1, -1},
       {1, -1, 1, -1, 1, -1, 1, -1},
       {1, -1, -1, 1, 1, -1, -1, 1},
       {1, 1, 1, 1, -1, -1, -1, -1},
       {1, 1, -1, -1, -1, -1, 1, 1},
       {1, -1, 1, -1, -1, 1, -1, 1},
       {1, -1, -1, 1, -1, 1, 1, -1}}}},
    {"D3", {{"A1", "A2", "E"}, {"E", "2C3", "3C2'"}, {{1, 1, 1}, {1, 1, -1}, {2, -1, 0}}}},
    {"D3d",
     {{"A1g", "A1u", "A2g", "A2u", "Eg", "Eu"},
      {"E", "2C3", "3C2'", "i", "2S6", "3sigmad"},
      {{1, 1, 1, 1, 1, 1},
       {1, 1, 1, -1, -1, -1},
       {1, 1, -1, 1, 1, -1},
       {1, 1, -1, -1, -1, 1},
       {2, -1, 0, 2, -1, 0},
       {2, -1, 0, -2, 1, 0}}}},
    {"D3h",
     {{"A1'", "A1''", "A2'", "A2''", "E'", "E''"},
      {"E", "sigmah", "2C3", "2S3", "3C2'", "3sigmav"},
      {{1, 1, 1, 1, 1, 1},
       {1, -1, 1, -1, 1, -1},
       {1, 1, 1, 1, -1, -1},
       {1, -1, 1, -1, -1, 1},
       {2, 2, -1, -1, 0, 0},
       {2, -2, -1, 1, 0, 0}}}},
    {"D4",
     {{"A1", "A2", "B1", "B2", "E"},
      {"E", "2C4", "C2", "2C2'", "2C2''"},
      {{1, 1, 1, 1, 1}, {1, 1, 1, -1, -1}, {1, -1, 1, 1, -1}, {1, -1, 1, -1, 1}, {2, 0, -2, 0, 0}}}},
    {"D4d",
     {{"A1", "A2", "B1", "B2", "E1", "E2", "E3"},
      {"E", "C2", "2C4", "2S8", "2S8^3", "4C2'", "4sigmad"},
      {{1, 1, 1, 1, 1, 1, 1},
       {1, 1, 1, 1, 1, -1, -1},
       {1, 1, 1, -1, -1, 1, -1},
       {1, 1, 1, -1, -1, -1, 1},
       {2, -2, 0, sqrt(2), -sqrt(2), 0, 0},
       {2, 2, -2, 0, 0, 0, 0},
       {2, -2, 0, -sqrt(2), sqrt(2), 0, 0}}}},
    {"D4h",
     {{"Ag1", "A1u", "A2g", "A2u", "B1g", "B1u", "B2g", "B2u", "Eg", "Eu"},
      {"E", "C2", "2C4", "2C2'", "2C2''", "i", "sigmah", "S4", "2sigmav", "2sigmad"},
      {{1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
       {1, 1, 1, 1, 1, -1, -1, -1, -1, -1},
       {1, 1, 1, -1, -1, 1, 1, 1, -1, -1},
       {1, 1, 1, -1, -1, -1, -1, -1, 1, 1},
       {1, 1, -1, 1, -1, 1, 1, -1, 1, -1},
       {1, 1, -1, 1, -1, -1, -1, 1, -1, 1},
       {1, 1, -1, -1, 1, 1, 1, -1, -1, 1},
       {1, 1, -1, -1, 1, -1, -1, 1, 1, -1},
       {2, -2, 0, 0, 0, 2, -2, 0, 0, 0},
       {2, -2, 0, 0, 0, -2, 2, 0, 0, 0}}}},
    {"D5",
     {{"A1", "A2", "E1", "E2"},
      {"E", "2C5", "2C5^2", "5C2"},
      {
          {1, 1, 1, 1},
          {1, 1, 1, -1},
          {2, 2 * thetaRe(5), 2 * thetaRe(2.5), 0},
          {2, 2 * thetaRe(2.5), 2 * thetaRe(5), 0},
      }}},
    {"D5d",
     {{"A1g", "A1u", "A2g", "A2u", "E1g", "E1u", "E2g", "E2u"},
      {"E", "2C5", "2C5^2", "5C2'", "i", "2S10", "2S10^3", "5sigmad"},
      {
          {1, 1, 1, 1, 1, 1, 1, 1},
          {1, 1, 1, 1, -1, -1, -1, -1},
          {1, 1, 1, -1, 1, 1, 1, -1},
          {1, 1, 1, -1, -1, -1, -1, 1},
          {2, 2 * thetaRe(5), 2 * thetaRe(2.5), 0, 2, 2 * thetaRe(2.5), 2 * thetaRe(5), 0},
          {2, 2 * thetaRe(5), 2 * thetaRe(2.5), 0, -2, -2 * thetaRe(2.5), -2 * thetaRe(5), 0},
          {2, 2 * thetaRe(2.5), 2 * thetaRe(5), 0, 2, 2 * thetaRe(5), 2 * thetaRe(2.5), 0},
          {2, 2 * thetaRe(2.5), 2 * thetaRe(5), 0, -2, -2 * thetaRe(5), -2 * thetaRe(2.5), 0},
      }}},
    {"D5h",
     {{"A1'", "A1''", "A2'", "A2''", "E1'", "E1''", "E2'", "E2''"},
      {"E", "2C5", "2C5^2", "5C2'", "sigmah", "2S5", "2S5^3", "5sigmav"},
      {
          {1, 1, 1, 1, 1, 1, 1, 1},
          {1, 1, 1, 1, -1, -1, -1, -1},
          {1, 1, 1, -1, 1, 1, 1, -1},
          {1, 1, 1, -1, -1, -1, -1, 1},
          {2, 2 * thetaRe(5), 2 * thetaRe(2.5), 0, 2, 2 * thetaRe(5), 2 * thetaRe(2.5), 0},
          {2, 2 * thetaRe(5), 2 * thetaRe(2.5), 0, -2, -2 * thetaRe(5), -2 * thetaRe(2.5), 0},
          {2, 2 * thetaRe(2.5), 2 * thetaRe(5), 0, 2, 2 * thetaRe(2.5), 2 * thetaRe(5), 0},
          {2, 2 * thetaRe(2.5), 2 * thetaRe(5), 0, -2, -2 * thetaRe(2.5), -2 * thetaRe(5), 0},

      }}},
    {"D6",
     {{"A1", "A2", "B1", "B2", "E1", "E2"},
      {"E", "2C6", "2C3", "C2", "3C2'", "3C2''"},
      {{1, 1, 1, 1, 1, 1},
       {1, 1, 1, 1, -1, -1},
       {1, -1, 1, -1, 1, -1},
       {1, -1, 1, -1, -1, 1},
       {2, 1, -1, -2, 0, 0},
       {2, -1, -1, 2, 0, 0}}}},
    {"D6d",
     {{"A1", "A2", "B1", "B2", "E1", "E2", "E3", "E4", "E5"},
      {"E", "2S12", "2C6", "2S4", "2C3", "2S12^5", "C2", "6C2'", "6sigmad"},
      {{1, 1, 1, 1, 1, 1, 1, 1, 1},
       {1, 1, 1, 1, 1, 1, 1, -1, -1},
       {1, -1, 1, -1, 1, -1, 1, 1, -1},
       {1, -1, 1, -1, 1, -1, 1, -1, 1},
       {2, sqrt(3), 1, 0, -1, -sqrt(3), -2, 0, 0},
       {2, 1, -1, -2, -1, 1, 2, 0, 0},
       {2, 0, -2, 0, 2, 0, -2, 0, 0},
       {2, -1, -1, 2, -1, -1, 2, 0, 0},
       {2, -sqrt(3), 1, 0, -1, sqrt(3), -2, 0, 0}}}},
    {"D6h",
     {{"A1g", "A2g", "B1g", "B2g", "E1g", "E2g", "A1u", "A2u", "B1u", "B2u", "E1u", "E2u"},
      {"E", "2C6", "2C3", "C2", "3C2'", "3C2''", "i", "2S3", "2S6", "sigmah", "3sigmad", "3sigmav"},
      {{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
       {1, 1, 1, 1, -1, -1, 1, 1, 1, 1, -1, -1},
       {1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1},
       {1, -1, 1, -1, -1, 1, 1, -1, 1, -1, -1, 1},
       {2, 1, -1, -2, 0, 0, 2, 1, -1, -2, 0, 0},
       {2, -1, -1, 2, 0, 0, 2, -1, -1, 2, 0, 0},
       {1, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -1},
       {1, 1, 1, 1, -1, -1, -1, -1, -1, -1, 1, 1},
       {1, -1, 1, -1, 1, -1, -1, 1, -1, 1, -1, 1},
       {1, -1, 1, -1 - 1, 1, -1, 1, -1, 1, 1, -1},
       {2, 1, -1, -2, 0, 0, -2, -1, 1, 2, 0, 0},
       {2, -1, -1, 2, 0, 0, -2, 1, 1, -2, 0, 0}}}},
    {"D8",
     {{"A1", "A2", "B1", "B2", "E1", "E2", "E3"},
      {"E", "2C8", "2C8^3", "2C4", "C2", "4C2'", "4C2''"},
      {{1, 1, 1, 1, 1, 1, 1},
       {1, 1, 1, 1, 1, -1, -1},
       {1, -1, -1, 1, 1, 1, -1},
       {1, -1, -1, 1, 1, -1, 1},
       {2, sqrt(2), -sqrt(2), 0, -2, 0, 0},
       {2, 0, 0, -2, 2, 0, 0},
       {2, -sqrt(2), sqrt(2), 0, -2, 0, 0}}}},
    {"D8h",
     {{"A1g", "A2g", "B1g", "B2g", "E1g", "E2g", "E3g", "A1u", "A2u", "B1u", "B2u", "E1u", "E2u", "E3u"},
      {"E", "2C8", "2C8^3", "2C4", "C2", "4C2'", "4C2''", "i", "2S8^3", "2S8", "2S4", "sigmah", "4sigmad", "4sigmav"},
      {
          {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
          {1, 1, 1, 1, 1, -1, -1, 1, 1, 1, 1, 1, -1, -1},
          {1, -1, -1, 1, 1, 1, -1, 1, -1, -1, 1, 1, 1, -1},
          {1, -1, -1, 1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1},
          {2, sqrt(2), -sqrt(2), 0, -2, 0, 0, 2, sqrt(2), -sqrt(2), 0, -2, 0, 0},
          {2, 0, 0, -2, 2, 0, 0, 2, 0, 0, -2, 2, 0, 0},
          {2, -sqrt(2), sqrt(2), 0, -2, 0, 0, 2, -sqrt(2), sqrt(2), 0, -2, 0, 0},
          {1, 1, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -1, -1},
          {1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -1, -1, 1, 1},
          {1, -1, -1, 1, 1, 1, -1, -1, 1, 1, -1, -1, -1, 1},
          {1, -1, -1, 1, 1, -1, 1, -1, 1, 1, -1, -1, 1, -1},
          {2, sqrt(2), -sqrt(2), 0, -2, 0, 0, -2, -sqrt(2), sqrt(2), 0, 2, 0, 0},
          {2, 0, 0, -2, 2, 0, 0, -2, 0, 0, 2, -2, 0, 0},
          {2, -sqrt(2), sqrt(2), 0, -2, 0, 0, -2, sqrt(2), -sqrt(2), 0, 2, 0, 0},
      }}},
    {"I",
     {{"A", "T1", "T2", "G", "H"},
      {"E", "12C5", "12C5^2", "20C3", "15C2"},
      {{1, 1, 1, 1, 1},
       {3, -thetaRe(2.5), -thetaRe(5), 0, -1},
       {3, -thetaRe(5), -thetaRe(2.5), 0, -1},
       {4, -1, -1, 1, 0},
       {5, 0, 0, -1, 1}}}},
    {"Ih",
     {{"Ag", "T1g", "T2g", "Gg", "Gg", "Au", "T1u", "T2u", "Gu", "Hu"},
      {"E", "12C5", "12C5^2", "20C3", "15C2", "i", "12S10", "12S10^3", "20S6", "15sigma"},
      {{1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
       {3, -thetaRe(2.5), -thetaRe(5), 0, -1, 3, -thetaRe(5), -thetaRe(2.5), 0, -1},
       {3, -thetaRe(5), -thetaRe(2.5), 0, -1, 3, -thetaRe(2.5), -thetaRe(5), 0, -1},
       {4, -1, -1, 1, 0, 4, -1, -1, 1, 0},
       {5, 0, 0, -1, 1, 5, 0, 0, -1, 1},
       {1, 1, 1, 1, 1, -1, -1, -1, -1, -1},
       {3, -thetaRe(2.5), -thetaRe(5), 0, -1, -3, thetaRe(5), thetaRe(2.5), 0, 1},
       {3, -thetaRe(5), -thetaRe(2.5), 0, -1, -3, thetaRe(2.5), thetaRe(5), 0, 1},
       {4, -1, -1, 1, 0, -4, 1, 1, -1, 0},
       {5, 0, 0, -1, 1, -5, 0, 0, 1, -1}}}},
    {"O",
     {{"A1", "A2", "E", "T1", "T2"},
      {"E", "8C3", "3C2", "6C2'", "6C4"},
      {{1, 1, 1, 1, 1}, {1, 1, 1, -1, -1}, {2, -1, 2, 0, 0}, {3, 0, -1, -1, 1}, {3, 0, -1, 1, -1}}}},
    {"Oh",
     {{"A1g", "A2g", "Eg", "T1g", "T2g", "A1u", "A2u", "Eu", "T1u", "T2u"},
      {"E", "8C3", "C2", "C2'", "C4", "i", "S6", "sigmah", "sigmad", "S4"},
      {{1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
       {1, 1, -1, -1, 1, 1, -1, 1, 1, -1},
       {2, -1, 0, 0, 2, 2, 0, -1, 2, 0},
       {3, 0, -1, 1, -1, 3, 1, 0, -1, -1},
       {3, 0, 1, -1, -1, 3, -1, 0, -1, 1},
       {1, 1, 1, 1, 1, -1, -1, -1, -1, -1},
       {1, 1, -1, -1, 1, -1, 1, -1, -1, 1},
       {2, -1, 0, 0, 2, -2, 0, 1, -2, 0},
       {3, 0, -1, 1, -1, -3, -1, 0, 1, 1},
       {3, 0, 1, -1, -1, -3, 1, 0, 1, -1}}}},
    {"T",
     {{"A", "E+", "E-", "T"},
      {"E", "4C3", "4C3^2", "3C2"},
      {{1, 1, 1, 1}, {1, -0.5, -0.5, 1}, {0, thetaIm(3), -thetaIm(3), 0}, {3, 0, 0, -1}}}},
    {"Td",
     {{"A1", "A2", "E", "T1", "T2"},
      {"E", "8C3", "3C2", "6sigmad", "6S4"},
      {{1, 1, 1, 1, 1}, {1, 1, 1, -1, -1}, {2, -1, 2, 0, 0}, {3, 0, -1, -1, 1}, {3, 0, -1, 1, -1}}}},
    {"Th",
     {{"Ag", "Eg+", "Eg-", "Tg", "Au", "Eu+", "Eu-", "Tu"},
      {"E", "4C3", "4C3^2", "3C2", "i", "4S6^5", "4S6", "3sigmah"},
      {{1, 1, 1, 1, 1, 1, 1, 1},
       {1, -0.5, -0.5, 1, 1, -0.5, -0.5, 1},
       {0, thetaIm(3), -thetaIm(3), 0, 0, thetaIm(3), -thetaIm(3), 0},
       {3, 0, 0, -1, 3, 0, 0, -1},
       {1, 1, 1, 1, -1, -1, -1, -1},
       {1, -0.5, -0.5, 1, -1, 0.5, 0.5, -1},
       {0, thetaIm(3), -thetaIm(3), 0, 0, -thetaIm(3), thetaIm(3), 0},
       {3, 0, 0, -1, -3, 0, 0, 1}}}},
    {"S4",
     {{"A", "B", "E+", "E-"}, {"E", "S4", "C2", "S4^3"}, {{1, 1, 1, 1}, {1, -1, 1, -1}, {1, 0, -1, 0}, {0, 1, 0, -1}}}},
    {"S6",
     {{"Ag", "Au", "Eg+", "Eg-", "Eu+", "Eu-"},
      {"E", "C3", "C3^2", "i", "S6", "S6^5"},
      {{1, 1, 1, 1, 1, 1},
       {1, 1, 1, -1, -1, -1},
       {1, -0.5, -0.5, 1, -0.5, -0.5},
       {0, 2 * thetaIm(6), -2 * thetaIm(6), 0, -2 * thetaIm(6), 2 * thetaIm(6)},
       {1, -0.5, -0.5, -1, 0.5, 0.5},
       {0, 2 * thetaIm(6), -2 * thetaIm(6), 0, 2 * thetaIm(6), -2 * thetaIm(6)}}}},
    {"S8",
     {{"A", "B", "E1+", "E1-", "E2+", "E2-", "E3+", "E3-"},
      {"E", "S8", "C4", "S8^3", "C2", "S8^5", "C4^3", "S8^7"},
      {{1, 1, 1, 1, 1, 1, 1, 1},
       {1, -1, 1, -1, 1, -1, 1, -1},
       {1, thetaRe(8), 0, -thetaRe(8), -1, -thetaRe(8), 0, thetaRe(8)},
       {0, 0, 1, 0, 0, 0, -1, 0},
       {1, 0, -1, 0, 1, 0, -1, 0},
       {0, 1, 0, -1, 0, 1, 0, -1},
       {1, -thetaRe(8), 0, thetaRe(8), -1, thetaRe(8), 0, -thetaRe(8)},
       {0, 0, -1, 0, 0, 0, 1, 0}}}}
};

} // namespace

namespace Symmetry
{

std::string CharacterTable::toString() const
{

    std::stringstream ss;
    ss << std::fixed << std::setprecision(3) << std::left << std::setw(6) << " ";
    for (const auto& className : classNames)
    {
        std::string name = className;
        if (className == "sigmad")
            name = "σd";
        else if (className == "sigmav")
            name = "σv";
        else if (className == "sigmah")
            name = "σh";
        else if (className == "sigmaxy")
            name = "σxy";
        else if (className == "sigmaxz")
            name = "σxz";
        else if (className == "sigmayz")
            name = "σyz";
        ss << std::setw(10) << name;
    }
    ss << "\n";
    for (size_t i = 0; i < irrepNames.size(); ++i)
    {
        ss << std::setw(6) << irrepNames[i];
        for (size_t j = 0; j < classNames.size(); ++j) { ss << std::setw(10) << characters[i][j]; }
        ss << "\n";
    }

    return ss.str();
}

const CharacterTable& getCharacterTable(const PointGroup& pg)
{
    // Check if the point group is in the predefined tables
    auto it = tables.find(pg.toString());
    if (it != tables.end())
    {
        return it->second;
    }

    // If not found, throw an exception
    throw std::runtime_error("Character table for point group '" + pg.toString() + "' not found.");
}

} // namespace Symmetry
